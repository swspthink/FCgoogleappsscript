<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>외근일지작성</title>
  </head>
  <body>
    <h2>외 근 일 지 작 성</h2><br><br>

    <script>
      function spreadSubmit(){
        if(teamid1.value.length == 0){
          alert("팀명을 선택하세요");
          teamid1.focus();
        }else if(mname1.value.length == 0){
          alert("성명을 입력하세요");
          mname1.focus();
        }else if(mdate1.value == ""){
          alert("시작일을 입력하세요");
          mdate1.focus();
        }else if(mdate2.value == ""){
          alert("마침일을 입력하세요");
          mdate2.focus();
        }else if(mname2.value.length == 0){
          alert("방문지를 입력하세요");
          mname2.focus();
        }else if(mname3.value.length == 0){
          alert("방문목적을 입력하세요");
          mname3.focus();
        }else{
          spreadSubmit2();
        }

        function spreadSubmit2(){
          google.script.run
          .withSuccessHandler(missionSuccess)
          .withFailureHandler(missionFail)
          .getValuesSpread(document.forms[0]);//앞서는 html에서 메세지를 보내고 그것을 .gs가 받아서 수행하고 그 결과값을 다시 html로 받아서 보여주었으나 이 명령어는 html에서 스크립트를 성공적으로 실행했느냐는 보여주는 것임. 명령어 기능상 차이가 있는 부분을 이해하면 됨
          document.getElementById("myForm").reset();
        }
        function missionSuccess(){
          alert("전송을 성공적으로 마쳤습니다.");
        }
        function missionFail(){
          alert("전송을 실패하였습니다..");
        }
      }
    </script>

    <table width="500" cellpadding="2" cellspacing="1" bgcolor="#cccccc">
      <form id="myForm">
        <tr>
        <td colspan="4" align="center"><b>세부사항입력</b></td>
        </tr>
        <tr>
        <td colspan="1" align="center" bgcolor="#f4f4f4">팀명</td>
        <td colspan="3" bgcolor="#ffffff"><select id="teamid1" name="teamid1" maxlength="10">
        <option value=""select>팀명선택</option>
        <option value="기획팀">기획팀</option>
        <option value="홍보팀">홍보팀</option>
        </select></td>
        </tr>

        <tr>
        <td colspan="1" align="center" bgcolor="#f4f4f4">성명</td>
        <td colspan="3" bgcolor="#ffffff"><input type="text" maxlength="10" size="10" id="mname1" name="mname1"></td>
        </tr>

        <tr>
        <td colspan="1" align="center" bgcolor="#f4f4f4">시작일시</td>
        <td colspan="3" bgcolor="#ffffff"><input type="datetime-local" id="mdate1" name="mdate1"></td>
        </tr>

        <tr>
        <td colspan="1" align="center" bgcolor="#f4f4f4">마침일시</td>
        <td colspan="3" bgcolor="#ffffff"><input type="datetime-local" id="mdate2" name="mdate2"></td>
        </tr>

        <tr>
        <td colspan="1" align="center" bgcolor="#f4f4f4">방문지</td>
        <td colspan="3" bgcolor="#ffffff"><input type="text" maxlength="20" size="20" id="mname2" name="mname2"></td>
        </tr>

        <tr>
        <td colspan="1" align="center" bgcolor="#f4f4f4">방문목적</td>
        <td colspan="3" bgcolor="#ffffff"><input type="text" maxlength="40" size="40" id="mname3" name="mname3"></td>
        </tr>


      </form>
    </table>
      <br>
      &nbsp;&nbsp;
      <input onclick="spreadSubmit()" type="button" value="입력">
  </body>
</html>
